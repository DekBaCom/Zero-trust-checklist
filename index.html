<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero Trust Ultimate Hub v11 (Full Matrix)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        msBlue: '#0078D4',
                        msDark: '#242424',
                        bgLight: '#f0f2f5',
                        brandBiz: '#7719aa',
                        brandE3: '#0f766e',
                        brandE5: '#0078D4',
                    },
                    fontFamily: {
                        sans: ['"Segoe UI"', 'Roboto', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f0f2f5; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        
        /* Interactive Card Styles */
        .option-card { 
            cursor: pointer; 
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 2px solid #e2e8f0; 
            background: white;
            position: relative;
            overflow: hidden;
        }
        .option-card:hover { 
            border-color: #93c5fd; 
            background-color: #f0f9ff; 
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .option-card.selected { 
            border-color: #0078D4; 
            background-color: #eff6fc; 
            box-shadow: 0 0 0 1px #0078D4;
        }
        .option-card.selected::after {
            content: '\f058'; /* Checkmark Icon */
            font-family: 'Font Awesome 6 Free'; 
            font-weight: 900;
            position: absolute; 
            top: 10px; 
            right: 10px; 
            color: #0078D4;
            font-size: 1.2rem;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }

        .glass-card {
            background: white;
            border: 1px solid rgba(229, 231, 235, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .glass-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }

        .hidden-view { display: none !important; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Navigation */
        .nav-tab.active { color: #0078D4; border-bottom: 2px solid #0078D4; background: #f0f9ff; }
        .nav-tab { color: #64748b; border-bottom: 2px solid transparent; }
        
        /* Table Styles */
        th.sticky-header { position: sticky; top: 0; background-color: #f8fafc; z-index: 10; border-bottom: 2px solid #e2e8f0; }
        
        /* Badges & Icons */
        .badge-biz { color: #7719aa; font-weight: bold; font-size: 0.75em; background: #f3e8ff; padding: 2px 8px; border-radius: 99px; border: 1px solid #d8b4fe; }
        .badge-e5 { color: #0078D4; font-weight: bold; font-size: 0.75em; background: #eff6fc; padding: 2px 8px; border-radius: 99px; border: 1px solid #bfdbfe; }
        .badge-basic { color: #64748b; font-size: 0.75em; background: #f1f5f9; padding: 2px 8px; border-radius: 99px; }
        
        .icon-check { color: #10b981; font-size: 1.1em; } /* Green Check */
        .icon-cross { color: #cbd5e1; font-size: 1.1em; } /* Grey Cross */
        .icon-partial { color: #f59e0b; font-size: 1.1em; } /* Orange Warning */

        /* Chart SVG Logic */
        .circular-chart { display: block; margin: 0 auto; max-width: 100%; max-height: 250px; }

        @media print {
            .no-print { display: none !important; }
            nav { display: none !important; }
            body { background-color: white; padding: 0; }
            #result-section { display: block !important; margin: 0; box-shadow: none; border: none; }
            .print-break { page-break-inside: avoid; }
        }
    </style>
</head>
<body class="text-slate-800 flex flex-col min-h-screen">

    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-3">
                    <div class="bg-msBlue text-white p-2 rounded-lg">
                        <i class="fa-brands fa-microsoft text-xl"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-lg text-slate-700 leading-tight">Zero Trust Hub</h1>
                        <p class="text-xs text-slate-500">Resource, Compare & Assess</p>
                    </div>
                </div>
                
                <div class="hidden md:flex space-x-2 h-full py-2">
                    <button onclick="switchView('hub')" id="tab-hub" class="nav-tab active px-4 rounded-lg font-semibold text-sm flex items-center gap-2 transition-colors">
                        <i class="fa-solid fa-book-open"></i> Hub
                    </button>
                    <button onclick="switchView('compare')" id="tab-compare" class="nav-tab px-4 rounded-lg font-semibold text-sm flex items-center gap-2 transition-colors">
                        <i class="fa-solid fa-table-list"></i> Full Comparison
                    </button>
                    <button onclick="switchView('assessment')" id="tab-assessment" class="nav-tab px-4 rounded-lg font-semibold text-sm flex items-center gap-2 transition-colors">
                        <i class="fa-solid fa-clipboard-check"></i> Assessment (10Q)
                    </button>
                </div>
            </div>
        </div>
        <div class="md:hidden flex border-t border-gray-100">
            <button onclick="switchView('hub')" id="mob-tab-hub" class="flex-1 py-3 text-center text-sm font-semibold text-msBlue bg-blue-50 transition-colors">Hub</button>
            <button onclick="switchView('compare')" id="mob-tab-compare" class="flex-1 py-3 text-center text-sm font-semibold text-slate-500 transition-colors">Compare</button>
            <button onclick="switchView('assessment')" id="mob-tab-assessment" class="flex-1 py-3 text-center text-sm font-semibold text-slate-500 transition-colors">Assess</button>
        </div>
    </nav>

    <main class="flex-grow">
        
        <div id="view-hub" class="fade-in">
            <div class="bg-slate-800 text-white py-12">
                <div class="max-w-7xl mx-auto px-4 text-center">
                    <h2 class="text-3xl font-bold mb-4">Zero Trust Architecture</h2>
                    <p class="text-slate-300 max-w-2xl mx-auto mb-8">Verify Explicitly ‚Ä¢ Use Least Privilege Access ‚Ä¢ Assume Breach</p>
                    <button onclick="switchView('assessment')" class="bg-msBlue hover:bg-blue-600 text-white px-8 py-3 rounded-full font-bold text-lg transition shadow-lg transform hover:scale-105">
                        Start Full Assessment <i class="fa-solid fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
                <div id="cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12"></div>
            </div>
        </div>

        <div id="view-compare" class="hidden-view fade-in">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-slate-800">Complete Feature Comparison</h2>
                    <p class="text-slate-500">Security Feature Matrix: Standard vs Business Premium vs Enterprise E5</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden">
                    <div class="overflow-x-auto max-h-[80vh]">
                        <table class="w-full text-sm text-left border-collapse">
                            <thead>
                                <tr>
                                    <th class="px-6 py-5 sticky-header shadow-sm bg-gray-50 text-slate-700 font-bold w-1/3 text-base">Feature Category / Capability</th>
                                    <th class="px-6 py-5 sticky-header shadow-sm text-center bg-purple-50 w-1/5 border-l border-r border-purple-100">
                                        <div class="font-bold text-brandBiz text-lg">Business Premium</div>
                                        <div class="text-xs text-slate-500 font-normal mt-1">SME (< 300 Users)</div>
                                    </th>
                                    <th class="px-6 py-5 sticky-header shadow-sm text-center bg-gray-50 border-r border-gray-200 w-1/5">
                                        <div class="font-bold text-slate-700 text-lg">Enterprise E3</div>
                                        <div class="text-xs text-slate-500 font-normal mt-1">Standard Corp</div>
                                    </th>
                                    <th class="px-6 py-5 sticky-header shadow-sm text-center bg-blue-50 w-1/5">
                                        <div class="font-bold text-msBlue text-lg">Enterprise E5</div>
                                        <div class="text-xs text-slate-500 font-normal mt-1">Full Security</div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100">
                                <tr class="bg-gray-50 font-bold text-slate-600">
                                    <td class="px-6 py-4">Est. Price (USD/User/Month)</td>
                                    <td class="px-6 py-4 text-center border-l border-r border-gray-200 text-brandBiz">~$22.00</td>
                                    <td class="px-6 py-4 text-center border-r border-gray-200">~$36.00</td>
                                    <td class="px-6 py-4 text-center text-msBlue">~$57.00</td>
                                </tr>

                                <tr class="bg-slate-100"><td colspan="4" class="px-6 py-3 font-bold text-xs text-slate-600 uppercase tracking-wider">1. Identity & Access (Entra ID)</td></tr>
                                
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Multi-Factor Authentication (MFA)</td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Conditional Access <span class="text-xs text-slate-400 block font-normal">Context-based policies (IP, Device, Loc)</span></td>
                                    <td class="px-6 py-3 text-center border-x"><span class="badge-biz">Plan 1</span></td>
                                    <td class="px-6 py-3 text-center border-r"><span class="badge-basic">Plan 1</span></td>
                                    <td class="px-6 py-3 text-center"><span class="badge-e5">Plan 2</span></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Identity Protection <span class="text-xs text-slate-400 block font-normal">Real-time Risk Detection & Blocking</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Privileged Identity Mgmt (PIM) <span class="text-xs text-slate-400 block font-normal">Just-In-Time Admin Access</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>

                                <tr class="bg-slate-100"><td colspan="4" class="px-6 py-3 font-bold text-xs text-slate-600 uppercase tracking-wider">2. Endpoint Management (Intune)</td></tr>
                                
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">MDM (Device Management) <span class="text-xs text-slate-400 block font-normal">Manage Windows, iOS, Android, macOS</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">MAM (Mobile App Management) <span class="text-xs text-slate-400 block font-normal">Protect App Data on Personal Devices</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Windows Autopilot <span class="text-xs text-slate-400 block font-normal">Zero-touch Deployment</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>

                                <tr class="bg-slate-100"><td colspan="4" class="px-6 py-3 font-bold text-xs text-slate-600 uppercase tracking-wider">3. Threat Protection (Defender)</td></tr>
                                
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Next-Gen Antivirus</td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Endpoint Detection & Response (EDR) <span class="text-xs text-slate-400 block font-normal">Advanced Post-breach hunting</span></td>
                                    <td class="px-6 py-3 text-center border-x"><span class="badge-biz">Included</span></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><span class="badge-e5">Included</span></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Email Safe Links & Attachments <span class="text-xs text-slate-400 block font-normal">Zero-day Phishing/Malware Protection</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Automated Investigation & Response <span class="text-xs text-slate-400 block font-normal">Self-healing AI</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>

                                <tr class="bg-slate-100"><td colspan="4" class="px-6 py-3 font-bold text-xs text-slate-600 uppercase tracking-wider">4. Information Protection (Purview)</td></tr>
                                
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Manual Sensitivity Labels</td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Data Loss Prevention (DLP) <span class="text-xs text-slate-400 block font-normal">Exchange, SharePoint, OneDrive</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-check icon-check"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Endpoint DLP <span class="text-xs text-slate-400 block font-normal">Block USB, Print, Clipboard on Devices</span></td>
                                    <td class="px-6 py-3 text-center border-x"><span class="badge-biz">Lite</span></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><span class="badge-e5">Full</span></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Auto-Labeling (AI) <span class="text-xs text-slate-400 block font-normal">Auto-classify data based on content</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>

                                <tr class="bg-slate-100"><td colspan="4" class="px-6 py-3 font-bold text-xs text-slate-600 uppercase tracking-wider">5. Cloud Apps & Shadow IT</td></tr>
                                
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Cloud App Discovery (Shadow IT)</td>
                                    <td class="px-6 py-3 text-center border-x"><span class="badge-basic">Basic</span></td>
                                    <td class="px-6 py-3 text-center border-r"><span class="badge-basic">Basic</span></td>
                                    <td class="px-6 py-3 text-center"><span class="badge-e5">Full</span></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-3 font-medium text-slate-700">Session Control (CASB) <span class="text-xs text-slate-400 block font-normal">Block downloads on unmanaged devices</span></td>
                                    <td class="px-6 py-3 text-center border-x"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center border-r"><i class="fa-solid fa-xmark icon-cross"></i></td>
                                    <td class="px-6 py-3 text-center"><i class="fa-solid fa-check icon-check"></i></td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-assessment" class="hidden-view max-w-5xl mx-auto px-4 py-10 fade-in">
            
            <div class="text-center mb-10 no-print">
                <span class="bg-blue-100 text-msBlue px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider">Interactive Tool</span>
                <h2 class="text-3xl font-bold text-slate-800 mt-3">Full Security Assessment</h2>
                <p class="text-slate-500 mt-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (10 ‡∏Ç‡πâ‡∏≠)</p>
            </div>

            <div id="assessment-form" class="space-y-10 no-print pb-20">
                <div>
                    <div class="flex items-center gap-2 mb-4 border-b pb-2">
                        <div class="w-8 h-8 rounded-full bg-msBlue text-white flex items-center justify-center font-bold">1</div>
                        <h3 class="text-xl font-bold text-slate-700">Identity & Foundation</h3>
                    </div>
                    <div class="grid grid-cols-1 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">1. License Microsoft 365 ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                <div class="option-card rounded-lg p-4" role="button" tabindex="0" onclick="selectOption('q1', 'none', this)"><div class="font-bold text-slate-700">None / Basic</div><div class="text-xs text-slate-500 mt-1">Google / Exchange Only</div></div>
                                <div class="option-card rounded-lg p-4" role="button" tabindex="0" onclick="selectOption('q1', 'biz', this)"><div class="font-bold text-brandBiz">Business Premium</div><div class="text-xs text-slate-500 mt-1">SME (<300 users)</div></div>
                                <div class="option-card rounded-lg p-4" role="button" tabindex="0" onclick="selectOption('q1', 'e3', this)"><div class="font-bold text-slate-700">Enterprise E3</div><div class="text-xs text-slate-500 mt-1">Standard Enterprise</div></div>
                                <div class="option-card rounded-lg p-4" role="button" tabindex="0" onclick="selectOption('q1', 'e5', this)"><div class="font-bold text-msBlue">Enterprise E5</div><div class="text-xs text-slate-500 mt-1">Full Zero Trust Suite</div></div>
                            </div>
                            <input type="hidden" id="q1">
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Identity) ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q2', 'onprem', this)"><div class="font-bold text-slate-700">On-prem AD Only</div><div class="text-xs text-slate-500 mt-1">Server ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q2', 'hybrid', this)"><div class="font-bold text-slate-700">Hybrid Identity</div><div class="text-xs text-slate-500 mt-1">Sync ‡∏Ç‡∏∂‡πâ‡∏ô Cloud</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q2', 'cloud', this)"><div class="font-bold text-slate-700">Cloud Only</div><div class="text-xs text-slate-500 mt-1">Entra ID Native</div></div>
                            </div>
                            <input type="hidden" id="q2">
                        </div>
                        
                         <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">3. ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (Authentication)?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q3', 'pass', this)"><div class="font-bold text-red-500">Password Only</div><div class="text-xs text-slate-500 mt-1">Weak Security</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q3', 'sms', this)"><div class="font-bold text-slate-700">Password + SMS</div><div class="text-xs text-slate-500 mt-1">Basic MFA</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q3', 'app', this)"><div class="font-bold text-green-600">Microsoft Auth App</div><div class="text-xs text-slate-500 mt-1">Strong MFA</div></div>
                            </div>
                            <input type="hidden" id="q3">
                        </div>
                    </div>
                </div>

                <div>
                      <div class="flex items-center gap-2 mb-4 border-b pb-2 pt-6">
                        <div class="w-8 h-8 rounded-full bg-purple-600 text-white flex items-center justify-center font-bold">2</div>
                        <h3 class="text-xl font-bold text-slate-700">Devices & Applications</h3>
                    </div>
                    <div class="grid grid-cols-1 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">4. ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Device Mgmt)?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q4', 'none', this)"><div class="font-bold text-slate-700">Unmanaged</div><div class="text-xs text-slate-500 mt-1">User ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏≠‡∏á</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q4', 'hybrid', this)"><div class="font-bold text-slate-700">Hybrid Join</div><div class="text-xs text-slate-500 mt-1">AD GPO + Intune</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q4', 'intune', this)"><div class="font-bold text-msBlue">Intune / Autopilot</div><div class="text-xs text-slate-500 mt-1">Modern Mgmt</div></div>
                            </div>
                            <input type="hidden" id="q4">
                        </div>
                         <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">5. ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏ß‡∏£‡∏±‡∏™ (Endpoint Protection)?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q5', 'legacy', this)"><div class="font-bold text-slate-700">Legacy / 3rd Party</div><div class="text-xs text-slate-500 mt-1">Signature-based AV</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q5', 'defender', this)"><div class="font-bold text-slate-700">Standard Defender</div><div class="text-xs text-slate-500 mt-1">Built-in Windows AV</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q5', 'edr', this)"><div class="font-bold text-green-600">Defender for Endpoint</div><div class="text-xs text-slate-500 mt-1">EDR / XDR</div></div>
                            </div>
                            <input type="hidden" id="q5">
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">6. ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Patch Windows?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q6', 'manual', this)"><div class="font-bold text-slate-700">Manual</div><div class="text-xs text-slate-500 mt-1">User ‡∏Å‡∏î update ‡πÄ‡∏≠‡∏á</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q6', 'wsus', this)"><div class="font-bold text-slate-700">WSUS / SCCM</div><div class="text-xs text-slate-500 mt-1">On-premise Server</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q6', 'autopatch', this)"><div class="font-bold text-msBlue">Windows Autopatch</div><div class="text-xs text-slate-500 mt-1">Cloud Automated</div></div>
                            </div>
                            <input type="hidden" id="q6">
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">7. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á Email (Phishing)?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q7', 'basic', this)"><div class="font-bold text-slate-700">Standard Exchange</div><div class="text-xs text-slate-500 mt-1">Basic Spam Filter</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q7', 'atp', this)"><div class="font-bold text-green-600">Defender for Office 365</div><div class="text-xs text-slate-500 mt-1">Safe Links / Attach</div></div>
                            </div>
                            <input type="hidden" id="q7">
                        </div>
                         <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">8. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Shadow IT (Cloud Apps)?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q8', 'none', this)"><div class="font-bold text-red-500">Uncontrolled</div><div class="text-xs text-slate-500 mt-1">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏•‡πá‡∏≠‡∏Å</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q8', 'firewall', this)"><div class="font-bold text-slate-700">Firewall Block</div><div class="text-xs text-slate-500 mt-1">‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q8', 'casb', this)"><div class="font-bold text-msBlue">CASB (Defender)</div><div class="text-xs text-slate-500 mt-1">Discovery & Policy</div></div>
                            </div>
                            <input type="hidden" id="q8">
                        </div>
                    </div>
                </div>

                <div>
                      <div class="flex items-center gap-2 mb-4 border-b pb-2 pt-6">
                        <div class="w-8 h-8 rounded-full bg-green-600 text-white flex items-center justify-center font-bold">3</div>
                        <h3 class="text-xl font-bold text-slate-700">Data & Network</h3>
                    </div>
                    <div class="grid grid-cols-1 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">9. ‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Protection)?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q9', 'none', this)"><div class="font-bold text-slate-700">None</div><div class="text-xs text-slate-500 mt-1">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q9', 'manual', this)"><div class="font-bold text-slate-700">Manual Labeling</div><div class="text-xs text-slate-500 mt-1">User ‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏á</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q9', 'auto', this)"><div class="font-bold text-msBlue">Auto Labeling</div><div class="text-xs text-slate-500 mt-1">AI ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div></div>
                            </div>
                            <input type="hidden" id="q9">
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h4 class="font-bold text-gray-800 mb-4">10. ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (Remote Access)?</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q10', 'public', this)"><div class="font-bold text-red-500">Direct Access</div><div class="text-xs text-slate-500 mt-1">Public IP / RDP</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q10', 'vpn', this)"><div class="font-bold text-slate-700">VPN</div><div class="text-xs text-slate-500 mt-1">Traditional VPN</div></div>
                                <div class="option-card rounded-lg p-4" onclick="selectOption('q10', 'ztna', this)"><div class="font-bold text-green-600">Zero Trust Access</div><div class="text-xs text-slate-500 mt-1">App Proxy / Global Secure Access</div></div>
                            </div>
                            <input type="hidden" id="q10">
                        </div>
                    </div>
                </div>

                <div class="text-center pt-8">
                    <button onclick="calculateGap()" class="bg-msBlue text-white px-10 py-4 rounded-full font-bold text-xl shadow-xl hover:bg-blue-700 transition transform hover:scale-105 active:scale-95">
                        <i class="fa-solid fa-wand-magic-sparkles mr-2"></i> Analyze & Recommend Plan
                    </button>
                </div>
            </div>

            <div id="result-section" class="hidden-view mt-4 mb-20">
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden print-break">
                    
                    <div class="bg-slate-800 text-white p-8">
                        <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                            <div>
                                <h2 class="text-3xl font-bold mb-1">Assessment Report</h2>
                                <p class="text-slate-400">Date: <span id="report-date"></span></p>
                            </div>
                             <div class="flex items-center gap-4">
                                <div class="relative w-24 h-24">
                                    <svg class="w-full h-full transform -rotate-90" viewBox="0 0 36 36">
                                        <path class="text-slate-700" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3" />
                                        <circle id="score-ring" cx="18" cy="18" r="15.9155" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="0, 100" class="text-msBlue transition-all duration-1000" />
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center font-bold text-2xl" id="score-text">0%</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xs text-slate-400 uppercase tracking-widest">Maturity Level</div>
                                    <div id="maturity-level" class="font-bold text-2xl text-yellow-400">Traditional</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-8">
                        <div class="bg-blue-50 border-l-4 border-msBlue p-6 mb-10 rounded-r-lg">
                            <h4 class="font-bold text-slate-800 mb-2 text-lg"><i class="fa-solid fa-chart-line mr-2 text-msBlue"></i>Executive Summary</h4>
                            <p id="summary-text" class="text-slate-700"></p>
                        </div>

                        <div class="mb-12">
                            <h3 class="font-bold text-xl text-slate-800 mb-6 flex items-center"><i class="fa-solid fa-star mr-2 text-yellow-500"></i> Recommended Plan</h3>
                            
                            <div class="flex flex-col md:flex-row border-2 border-msBlue rounded-xl overflow-hidden shadow-md">
                                <div class="bg-slate-50 p-8 w-full md:w-1/3 flex flex-col justify-center items-center border-b md:border-b-0 md:border-r border-gray-200 text-center">
                                    <div class="text-sm text-slate-500 uppercase font-bold tracking-wide mb-2">Best Fit Solution</div>
                                    <div id="rec-plan-name" class="text-3xl font-extrabold text-msBlue mb-2">Microsoft 365</div>
                                    <div class="text-4xl font-bold text-slate-800 mb-1" id="rec-plan-price"></div>
                                    <div class="text-xs text-slate-500 mb-6">per user / month (estimated)</div>
                                    <a href="mailto:Abdulloh.eg@gmail.com" class="bg-msBlue text-white px-6 py-2 rounded-full font-bold hover:bg-blue-700 transition w-full">Contact Sales</a>
                                </div>
                                
                                <div class="p-8 w-full md:w-2/3 bg-white">
                                    <h4 class="font-bold text-slate-800 mb-4">Why this plan?</h4>
                                    <ul id="rec-reasons" class="space-y-3"></ul>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 mb-8">
                             <div>
                                <h4 class="font-bold text-green-600 uppercase text-sm border-b pb-2 mb-4">‚úÖ Current Strength</h4>
                                <ul id="list-have" class="space-y-3 text-sm text-slate-700"></ul>
                            </div>
                            <div>
                                <h4 class="font-bold text-red-600 uppercase text-sm border-b pb-2 mb-4">‚ö†Ô∏è Critical Security Gaps</h4>
                                <ul id="list-need" class="space-y-3 text-sm text-slate-700"></ul>
                            </div>
                        </div>
                        
                        <div class="mb-8">
                            <h4 class="font-bold text-msBlue uppercase text-sm border-b pb-2 mb-4">üó∫Ô∏è Implementation Roadmap</h4>
                             <div class="space-y-4">
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 rounded-full bg-slate-100 text-slate-600 flex-shrink-0 flex items-center justify-center font-bold text-xs">P1</div>
                                    <div><div class="font-bold text-sm text-slate-800">Phase 1: Foundation (0-30 Days)</div><ul id="roadmap-p1" class="text-xs text-slate-500 mt-1 list-disc ml-4"></ul></div>
                                </div>
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 rounded-full bg-slate-100 text-slate-600 flex-shrink-0 flex items-center justify-center font-bold text-xs">P2</div>
                                    <div><div class="font-bold text-sm text-slate-800">Phase 2: Policy (1-3 Months)</div><ul id="roadmap-p2" class="text-xs text-slate-500 mt-1 list-disc ml-4"></ul></div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-12 flex justify-center gap-4 no-print border-t pt-8">
                            <button onclick="window.print()" class="px-8 py-3 border border-gray-300 rounded-full text-slate-600 font-bold hover:bg-gray-50 transition flex items-center">
                                <i class="fa-solid fa-print mr-2"></i> Print Report
                            </button>
                            <button onclick="resetAssessment()" class="px-8 py-3 bg-slate-800 rounded-full text-white font-bold hover:bg-slate-700 transition flex items-center">
                                <i class="fa-solid fa-rotate-right mr-2"></i> Start New Assessment
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-slate-800 text-slate-400 py-6 mt-auto text-center text-sm border-t border-slate-700 no-print">
        <p>&copy; <span id="year"></span>  Mr.Abdulloh Etaelue-ngoh. All rights reserved.</p>
        <p class="mt-1 text-xs text-slate-500">Reference: Microsoft Zero Trust Guidance</p>
    </footer>

    <script>
        document.getElementById('year').textContent = new Date().getFullYear();

        // --- Tabs Logic ---
        function switchView(viewName) {
            ['view-hub', 'view-compare', 'view-assessment'].forEach(id => {
                const el = document.getElementById(id);
                if(el) el.classList.add('hidden-view');
            });
            const target = document.getElementById('view-' + viewName);
            if(target) target.classList.remove('hidden-view');

            ['tab-hub', 'tab-compare', 'tab-assessment'].forEach(id => {
                const el = document.getElementById(id);
                if(el) el.classList.remove('active');
            });
            const activeTab = document.getElementById('tab-' + viewName);
            if(activeTab) activeTab.classList.add('active');

            // Sync Mobile
            const mobTabs = ['mob-tab-hub', 'mob-tab-compare', 'mob-tab-assessment'];
            mobTabs.forEach(id => {
                const el = document.getElementById(id);
                if(el) {
                    el.classList.remove('text-msBlue', 'bg-blue-50');
                    el.classList.add('text-slate-500');
                }
            });
            const activeMobTab = document.getElementById('mob-tab-' + viewName);
            if(activeMobTab) {
                activeMobTab.classList.remove('text-slate-500');
                activeMobTab.classList.add('text-msBlue', 'bg-blue-50');
            }

            window.scrollTo(0,0);
        }

        // --- Resource Hub Data ---
        const resources = [
            { title: "Identity", icon: "fa-id-card", color: "text-purple-600", desc: "Strong Auth", items: ["Entra ID", "MFA", "Conditional Access"], link: "https://learn.microsoft.com/en-us/security/zero-trust/deploy/identity" },
            { title: "Endpoints", icon: "fa-laptop-medical", color: "text-blue-600", desc: "Device Health", items: ["Intune", "Defender EDR", "Compliance"], link: "https://learn.microsoft.com/en-us/security/zero-trust/deploy/endpoints" },
            { title: "Apps", icon: "fa-cubes", color: "text-orange-600", desc: "Shadow IT", items: ["Cloud App Security", "App Proxy", "SSO"], link: "https://learn.microsoft.com/en-us/security/zero-trust/deploy/applications" },
            { title: "Data", icon: "fa-file-shield", color: "text-green-600", desc: "Info Protection", items: ["Sensitivity Labels", "DLP", "Encryption"], link: "https://learn.microsoft.com/en-us/security/zero-trust/deploy/data" },
            { title: "Infrastructure", icon: "fa-server", color: "text-red-600", desc: "Threat Detection", items: ["Defender for Identity", "Azure Arc", "XDR"], link: "https://learn.microsoft.com/en-us/security/zero-trust/deploy/infrastructure" },
             { title: "Network", icon: "fa-network-wired", color: "text-slate-600", desc: "Secure Access", items: ["ZTNA", "Segmentation", "Encryption"], link: "https://learn.microsoft.com/en-us/security/zero-trust/deploy/networks" }
        ];

        const container = document.getElementById('cards-container');
        if(container) {
            container.innerHTML = ''; 
            resources.forEach(item => {
                const card = document.createElement('div');
                card.className = "glass-card rounded-xl p-6 flex flex-col h-full relative group";
                card.innerHTML = `
                    <div class="flex items-center gap-3 mb-4">
                        <i class="fa-solid ${item.icon} ${item.color} text-2xl"></i>
                        <h4 class="font-bold text-lg text-slate-800">${item.title}</h4>
                    </div>
                    <p class="text-xs text-slate-500 uppercase font-semibold mb-3 tracking-wide">${item.desc}</p>
                    <ul class="space-y-2 mt-auto mb-4">
                        ${item.items.map(i => `<li class="text-sm text-slate-600 flex items-center gap-2"><i class="fa-solid fa-check text-green-500 text-xs"></i> ${i}</li>`).join('')}
                    </ul>
                    <a href="${item.link}" target="_blank" class="text-xs font-semibold text-msBlue hover:underline flex items-center gap-1 mt-auto pt-4 border-t border-gray-100">
                        Learn on Microsoft Docs <i class="fa-solid fa-arrow-up-right-from-square"></i>
                    </a>
                `;
                container.appendChild(card);
            });
        }

        function selectOption(qId, value, element) {
            const input = document.getElementById(qId);
            if(input) input.value = value;
            
            const container = element.parentElement;
            if(container) {
                const options = container.querySelectorAll('.option-card');
                options.forEach(opt => opt.classList.remove('selected'));
            }
            element.classList.add('selected');
        }

        // --- CALCULATION ENGINE ---
        function calculateGap() {
            const qIds = ['q1','q2','q3','q4','q5','q6','q7','q8','q9','q10'];
            const answers = {};
            let missing = false;

            for (const id of qIds) {
                const el = document.getElementById(id);
                if (!el || !el.value) { missing = true; } 
                else { answers[id] = el.value; }
            }

            if(missing) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏£‡∏±‡∏ö (Please answer all 10 questions)");
                return;
            }

            let score = 0;
            let have = [], need = [];
            let p1 = [], p2 = [], p3 = [];
            let whyRec = []; 

            // Logic Engine
            if(answers.q1 === 'e5' || answers.q1 === 'biz') score += 10; else if(answers.q1 === 'e3') score += 5;
            
            if(answers.q2 !== 'onprem') { score += 10; have.push("Cloud Identity Ready"); }
            else { need.push("Setup Hybrid Identity"); p1.push("Install Entra Connect"); whyRec.push("<b>Hybrid Identity:</b> Sync On-prem users to Cloud."); }

            if(answers.q3 === 'app') { score += 10; have.push("Strong MFA (App)"); }
            else if(answers.q3 === 'sms') { score += 5; need.push("Move SMS to App MFA"); p1.push("Enforce App MFA"); whyRec.push("<b>Entra ID P1:</b> Enforce Strong MFA."); }
            else { need.push("Enable MFA Immediately"); p1.push("Turn on MFA for All"); whyRec.push("<b>MFA Enforcement:</b> Critical for Identity Security."); }

            if(answers.q4 === 'intune') { score += 10; have.push("Cloud Device Mgmt"); }
            else if(answers.q4 === 'hybrid') { score += 5; need.push("Migrate GPO to Intune"); p2.push("Move workloads to Intune"); whyRec.push("<b>Intune:</b> Manage devices from Cloud."); }
            else { need.push("Implement Device Mgmt"); p2.push("Enroll Devices to Intune"); whyRec.push("<b>Intune:</b> Secure unmanaged devices."); }

            if(answers.q5 === 'edr') { score += 10; have.push("EDR Protection"); }
            else if(answers.q5 === 'defender') { score += 5; need.push("Upgrade to EDR"); p2.push("Deploy Defender for Endpoint"); whyRec.push("<b>Defender for Business:</b> Enterprise-grade EDR."); }
            else { need.push("Replace Legacy AV"); p1.push("Install Defender AV"); whyRec.push("<b>Defender for Business:</b> Replace legacy AV."); }

            if(answers.q6 === 'autopatch') { score += 10; have.push("Automated Patching"); }
            else { need.push("Automate Patching"); p2.push("Config Update Rings"); }

            if(answers.q7 === 'atp') { score += 10; have.push("Email ATP"); }
            else { need.push("Enable Anti-Phishing"); p1.push("Config Safe Links"); whyRec.push("<b>Defender for Office:</b> Protect against Phishing."); }

            if(answers.q8 === 'casb') { score += 10; have.push("CASB Control"); }
            else { need.push("Control Shadow IT"); p3.push("Setup Cloud App Discovery"); }

            if(answers.q9 === 'auto') { score += 10; have.push("Auto Labeling"); }
            else if(answers.q9 === 'manual') { score += 5; need.push("Automate Labeling"); p3.push("Config Sensitivity Labels"); whyRec.push("<b>Info Protection:</b> Encrypt sensitive data."); }
            else { need.push("Protect Data"); p3.push("Define Data Schema"); whyRec.push("<b>Info Protection:</b> Prevent data leakage."); }

            if(answers.q10 === 'ztna') { score += 10; have.push("Zero Trust Access"); }
            else if(answers.q10 === 'vpn') { score += 5; need.push("Move VPN to ZTNA"); p2.push("Setup App Proxy"); }
            else { need.push("Block Direct Access"); p1.push("Block RDP/Direct IP"); }

            // Recommendations
            let recTitle = "", recPrice = "", rationale = "", summary = "";
            let finalReasons = [];

            if(answers.q1 === 'e5') {
                recTitle = "Microsoft 365 E5"; recPrice = "Owned"; summary = "You have the ultimate toolset. Focus on turning on advanced features.";
                rationale = "Enable E5 Risk-based policies and Automation.";
                finalReasons = ["You already own the best suite.", "Enable Automated Security.", "Maximize your ROI."];
            } else if(answers.q1 === 'biz') {
                recTitle = "Business Premium"; recPrice = "Owned"; summary = "Business Premium is excellent. Ensure Defender & Intune are active.";
                rationale = "You have EDR and Intune. Make sure they are deployed.";
                finalReasons = ["Great SME Choice.", "Activate Defender for Business.", "Onboard devices to Intune."];
            } else {
                if(answers.q1 === 'e3') {
                     recTitle = "Add: M365 E5 Security"; recPrice = "+$12.00";
                     summary = "Upgrade your E3 with E5 Security Add-on.";
                     finalReasons = ["Add EDR & Identity Protection.", "Keep E3 Compliance features.", "Cost-effective upgrade."];
                } else {
                     recTitle = "Microsoft 365 Business Premium"; recPrice = "~$22.00"; 
                     summary = "Significant gaps found. Upgrade to a unified security suite.";
                     rationale = "Best value to get Intune, Defender, and MFA.";
                     finalReasons = whyRec.length > 0 ? whyRec.slice(0,4) : ["Includes Intune & Defender", "Enterprise-grade Security", "Best Value for <300 users"];
                }
            }

            // Render Results
            const reportDateEl = document.getElementById('report-date');
            if(reportDateEl) reportDateEl.innerText = new Date().toLocaleDateString();
            
            document.getElementById('score-text').innerText = score + "%";
            
            // Circle Logic Fixed (Circumference of r=15.9155 is approx 100)
            const circle = document.getElementById('score-ring');
            if(circle) {
                // Stroke Dasharray: [Filled, Empty]
                // Example: Score 70 => "70, 100" (Fill 70, gap rest)
                circle.style.strokeDasharray = `${score}, 100`;
            }

            const levelEl = document.getElementById('maturity-level');
            if(score < 50) { 
                levelEl.innerText = "Traditional"; 
                levelEl.className = "font-bold text-2xl text-red-500"; 
                circle.classList.remove('text-msBlue', 'text-green-500'); circle.classList.add('text-red-500'); 
            } else if(score < 80) { 
                levelEl.innerText = "Advanced"; 
                levelEl.className = "font-bold text-2xl text-msBlue"; 
                circle.classList.remove('text-red-500', 'text-green-500'); circle.classList.add('text-msBlue'); 
            } else { 
                levelEl.innerText = "Optimal"; 
                levelEl.className = "font-bold text-2xl text-green-500"; 
                circle.classList.remove('text-red-500', 'text-msBlue'); circle.classList.add('text-green-500'); 
            }

            document.getElementById('summary-text').innerText = summary;
            
            // Populate Lists safely
            const listHave = document.getElementById('list-have');
            if(listHave) listHave.innerHTML = have.length ? have.map(t => `<li><i class="fa-solid fa-check text-green-600"></i> ${t}</li>`).join('') : '<li class="text-slate-400">None detected</li>';
            
            const listNeed = document.getElementById('list-need');
            if(listNeed) listNeed.innerHTML = need.length ? need.map(t => `<li><i class="fa-solid fa-xmark text-red-500"></i> ${t}</li>`).join('') : '<li class="text-green-600">No critical gaps!</li>';

            document.getElementById('roadmap-p1').innerHTML = p1.length ? p1.map(t=>`<li>${t}</li>`).join('') : "<li>Review Foundations</li>";
            document.getElementById('roadmap-p2').innerHTML = p2.length ? p2.map(t=>`<li>${t}</li>`).join('') : "<li>Review Policy</li>";

            document.getElementById('rec-plan-name').innerText = recTitle;
            document.getElementById('rec-plan-price').innerText = recPrice;
            document.getElementById('rec-reasons').innerHTML = finalReasons.map(r => `<li class="flex items-start gap-3"><i class="fa-solid fa-check-circle text-green-500 mt-1"></i> <span class="text-sm text-slate-600">${r}</span></li>`).join('');

            document.getElementById('assessment-form').classList.add('hidden-view');
            document.getElementById('result-section').classList.remove('hidden-view');
            
            setTimeout(() => {
                document.getElementById('result-section').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        function resetAssessment() {
            document.getElementById('assessment-form').classList.remove('hidden-view');
            document.getElementById('result-section').classList.add('hidden-view');
            document.querySelectorAll('input[type="hidden"]').forEach(i => i.value = '');
            document.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
            window.scrollTo(0,0);
        }
    </script>
</body>
</html>